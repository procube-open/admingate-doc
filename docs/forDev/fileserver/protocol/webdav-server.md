---
sidebar_position: 50
---
# WebDAV
ベースとなるパッケージとして```webdav-server```を用いる。
`metadata.accessHistory`の`Protocol`は`browser`で記録される。
```selenium```のchromeコンテナに対して、```davfs```を用いてこれをマウントすることで、ファイルサーバから直接ファイルシステムの形でファイルにアクセスすることができる。

FTPと異なる点のみ以下に記す。

### ログイン方法
Guacamole の UI でログインし、接続ボタンを押すと、davfs-volumeとそれをマウントするChromeコンテナが動的に建てられる。davfs-volume は /mnt 配下にマウントされ、Chromeコンテナではマウントしたボリュームのみ参照できる。

この時点でログインに成功しているため、WebDAVサーバではユーザ名、パスワードによる認証や fs.works の whitelist を使った送信元IPによる制限は行わない。

ファイル一覧を取得すると、ログイン時に入力した作業IDの作業ディレクトリと、publicディレクトリのみが表示されている。

### moveの動作
moveはFTPのrenameと動作に相違があるため、以下に明記する。（WebDAVのmoveはlinuxのmvコマンドに近い。ただし完全に一致ではない）

- 変更先に"/"を含む値（ディレクトリを含むパス）を許可する。FTPではエラーとなる
- 変更元と変更先の親ディレクトリが異なるパターンの変更も可能とする
- 変更先に既に存在するディレクトリのパスが指定された場合は、変更元がファイルかディレクトリかに関係なくエラーとする

[参考]
> 変更先に"/"を含む値が許可されることで、WebDAVでは親ディレクトリが変更されるようなリネーム（移動）ができるのに対し、FTPでは変更元のディレクトリ名（親ディレクトリまでは同じ）に対して変更先の名前でリネームが行われる

[制限事項]
> 変更先のディレクトリ配下に既にファイル等が存在するmoveを実行した場合、/mnt ディレクトリに対する操作が出来なくなる
